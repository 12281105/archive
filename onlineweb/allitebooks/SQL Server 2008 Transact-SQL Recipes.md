http://www.allitebooks.com/sql-server-2008-transact-sql-recipes/