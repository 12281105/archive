http://www.allitebooks.com/expert-t-sql-window-functions-in-sql-server/